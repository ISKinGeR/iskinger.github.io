<!doctype html>
<html lang="en" dir="rtl" data-theme="midnight">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>IamKR</title>
  <style>
    :root {
      --bg: #0b1220;
      --bg-2: #0e1526;
      --card: rgba(255,255,255,0.04);
      --text: #e6eef8;
      --muted: #a8b3cf;
      --brand: #7dd3fc;
      --brand-2: #c052ff;
      --accent: #22d3ee;
      --ok: #34d399;
      --warn: #f59e0b;
      --danger: #ef4444;
      --shadow: 0 12px 38px rgba(2,6,23,0.55);
      --radius: 16px;
      --container: 1120px;
      --ease: cubic-bezier(.2,.8,.2,1);
      --card-w: min(360px, 92vw);
      --card-h: clamp(280px, 40vh, 320px);
    }

    html, body {
      height: 100%;
      scroll-behavior: smooth;
      background: radial-gradient(1600px 800px at 50% -10%, #0f1b33, var(--bg));
      color: var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      text-rendering: optimizeLegibility;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      overflow-x: hidden;
    }

    #bgCanvas { position: fixed; inset: 0; z-index: 0; pointer-events: none; filter: blur(16px) saturate(120%); opacity: .8; }

    header {
      position: fixed; top: 0; left: 0; right: 0; z-index: 10;
      backdrop-filter: saturate(140%) blur(10px);
      background: linear-gradient(180deg, rgba(11,18,32,0.92), rgba(11,18,32,0.65));
      border-bottom: 1px solid rgba(125,211,252,0.12);
      transform: translateY(-100%);
      transition: transform 900ms var(--ease);
    }
    header.enter { transform: translateY(0); }

    .navwrap { max-width: var(--container); margin: 0 auto; padding: 14px 20px; display: flex; gap: 8px; align-items: center; justify-content: space-between; }
    .brand { display: flex; align-items: center; gap: 12px; font-weight: 700; letter-spacing: .4px; }
    .brand .dot { width: 10px; height: 10px; border-radius: 999px; background: linear-gradient(45deg, var(--brand), var(--brand-2)); box-shadow: 0 0 18px rgba(125,211,252,.5); }

    nav a { color: var(--text); opacity: .7; text-decoration: none; padding: 10px 12px; border-radius: 10px; transition: 200ms var(--ease); font-weight: 600; }
    nav a:hover { opacity: 1; background: rgba(255,255,255,0.06); }
    nav a.active { opacity: 1; background: rgba(125,211,252,0.15); box-shadow: inset 0 0 0 1px rgba(125,211,252,0.25); }

    .nav-right { display:flex; align-items:center; gap:10px; }
    .chip { border:1px solid rgba(125,211,252,0.35); color: var(--text); background: rgba(255,255,255,0.03); padding:8px 12px; border-radius: 999px; cursor:pointer; transition: 200ms var(--ease); }
    .chip:hover { transform: translateY(-1px); background: rgba(255,255,255,0.06); }

    .spacer { height: 84px; }

    main { position: relative; z-index: 1; }
    .container { max-width: var(--container); margin: 0 auto; padding: 32px 20px 80px; }

    h1,h2,h3,p { text-align: center; }
    h1 { font-size: clamp(28px, 4vw, 44px); margin: 0 0 10px; }
    h2 { font-size: clamp(22px, 3vw, 30px); margin: 26px 0 16px; }
    p.lead { color: var(--muted); font-size: clamp(14px, 2vw, 18px); margin-bottom: 22px; }

    .grid { display: grid; grid-template-columns: repeat(12, 1fr); gap: 16px; }
    .col-12 { grid-column: span 12; }
    .col-6 { grid-column: span 6; }
    .col-4 { grid-column: span 4; }
    @media (max-width: 900px){ .col-6 { grid-column: span 12; } .col-4 { grid-column: span 12; } }

    .card { background: var(--card); border: 1px solid rgba(125,211,252,0.12); border-radius: var(--radius); box-shadow: var(--shadow); padding: 18px; position: relative; overflow: hidden;
      width: 300px;
      min-width: 280px;
      max-width: 300px;
      height: 150px;
      min-height: 150px;
      max-height: 150px;
    }
    .card .title { font-weight: 700; margin-bottom: 6px; }
    .card .muted { color: var(--muted); font-size: .95em; }
    .tags { display:flex; flex-wrap: wrap; gap: 16px; justify-content: center; text-decoration:none; transition: 220ms var(--ease)}
    .tag { background: rgba(125,211,252,0.15); border: 1px solid rgba(125,211,252,0.25); padding: 6px 10px;  border-radius: 12px; font-size: 12px; }
    .card2 { background: var(--card); border: 1px solid rgba(125,211,252,0.12); border-radius: var(--radius); box-shadow: var(--shadow); padding: 18px; position: relative; overflow: hidden; }
    .card3 { background: var(--card); border: 1px solid rgba(125,211,252,0.12); border-radius: var(--radius); box-shadow: var(--shadow); padding: 18px; position: relative; overflow: hidden;
      height: 130px;
      min-height: 85px;
      max-height: 130px;
    }
    .btn2 { display:inline-flex; align-items:center; gap:8px; background: linear-gradient(135deg, rgba(125,211,252,0.16), rgba(155,140,255,0.14)); border: 1px solid rgba(125,211,252,0.28); color:var(--text); padding: 4px 4px; border-radius: 12px; text-decoration:none; transition: 220ms var(--ease); 
      max-width: 1000px;
      max-height: 1000px;
      padding-top: -110000px;
    }


    .btn { display:inline-flex; align-items:center; gap:8px; background: linear-gradient(135deg, rgba(125,211,252,0.16), rgba(155,140,255,0.14)); border: 1px solid rgba(125,211,252,0.28); color:var(--text); padding: 10px 14px; border-radius: 12px; text-decoration:none; transition: 220ms var(--ease); }
    .btn:hover { transform: translateY(-1px); box-shadow: 0 8px 24px rgba(125,211,252,0.22); }

    section.view { display: none; }
    section.view.active { display: block; }

    .media { width: 100%; aspect-ratio: 16/9; border-radius: 12px; border:1px solid rgba(125,211,252,0.18); background: #0a1020; overflow: hidden; }
    .media iframe, .media img { width: 100%; height: 100%; display: block; object-fit: cover; }

    .modal { position: fixed; inset: 0; background: rgba(4,6,17,0.75); display:none; align-items:center; justify-content:center; z-index: 50; }
    .modal.open { display:flex; animation: fadeIn 300ms var(--ease); }
    .modal img { max-width: 92vw; max-height: 86vh; border-radius: 14px; border: 1px solid rgba(125,211,252,0.25); box-shadow: var(--shadow); }
    @keyframes fadeIn { from { opacity: 0 } to { opacity: 1 } }

    .reveal { opacity: 0; transform: translateY(14px) scale(.98); transition: 800ms var(--ease); }
    .reveal.in { opacity: 1; transform: translateY(0) scale(1); }

    html[dir="rtl"] nav a { font-weight: 700; }
    html[dir="rtl"] .brand { flex-direction: row-reverse; }
  </style>
</head>
<body>
  <canvas id="bgCanvas"></canvas>

  <header id="siteHeader">
    <div class="navwrap">
      <div class="brand"><span class="dot"></span><span id="brandText">Ø­Ø§Ø²Ù…</span></div>
      <nav id="mainNav">
        <a href="#home" data-route="home" class="active" data-i18n="nav.home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
        <a href="#projects" data-route="projects" data-i18n="nav.projects">Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</a>
        <a href="#previews" data-route="previews" data-i18n="nav.previews">Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø§Øª</a>
        <a href="#contact" data-route="contact" data-i18n="nav.contact">Ø§Ù„ØªÙˆØ§ØµÙ„</a>
      </nav>
      <div class="nav-right">
        <button class="chip" id="langToggle" title="Language">EN</button>
      </div>
    </div>
  </header>
  <div class="spacer"></div>

  <main>
    <section id="home" class="view active">
      <div class="container">
        <div class="grid">
          <div class="col-12">
            <h1 class="reveal" data-i18n="home.title">Ø£Ù‡Ù„Ø§Ù‹! Ø£Ù†Ø§ Ø­Ø§Ø²Ù… â€” Ù…Ø·ÙˆÙ‘Ø± Ù†Ø¸Ù… ÙˆØ®ÙˆØ§Ø¯Ù… Ø£Ù„Ø¹Ø§Ø¨</h1>
            <p class="lead reveal" data-i18n="home.subtitle">Ù‡Ù†Ø§ Ø£Ø¹Ø±Ø¶ Ø£ÙØ¶Ù„ Ø´ØºÙ„ÙŠ: Ø³ÙƒØ±Ø¨ØªØ§ØªØŒ Ø£Ù†Ø¸Ù…Ø©ØŒ ÙˆÙˆØ§Ø¬Ù‡Ø§Øª Ù…Ø®ØµØµØ©. ÙƒÙ„Ù‡Ø§ Ø¨Ù†ÙØ³ Ø§Ù„Ø«ÙŠÙ… ÙˆØ§Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ø³Ù„Ø³Ø© ğŸ‘‹</p>
          </div>
          <div class="col-12">
            <h2 class="reveal" data-i18n="home.featured">Ø£Ø¨Ø±Ø² Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</h2>
          </div>
        </div>
        <div id="featuredGrid" class="grid reveal"></div>
        <div class="col-12" style="margin-top:22px; text-align:center;">
          <a class="btn" href="#projects" data-i18n="home.seeAll">Ø´ÙˆÙ ÙƒÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</a>
        </div>
      </div>
    </section>

    <section id="projects" class="view">
      <div class="container">
        <h2 class="reveal" data-i18n="projects.title">ÙƒÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø¹Ø§Ù…Ø©</h2>
        <p class="lead reveal" data-i18n="projects.subtitle">ÙŠØªÙ… Ø¬Ù„Ø¨Ù‡Ø§ Ø£ÙˆØªÙˆÙ…Ø§ØªÙŠÙƒÙŠØ§Ù‹ Ù…Ù† GitHub Ù…Ø¹ Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³ÙˆØ¯Ø§Ø¡.</p>
        <div id="projectsGrid" class="grid reveal"></div>
        <div id="projectsError" class="col-12" style="display:none; text-align:center; color:var(--danger); margin-top:16px;"></div>
      </div>
    </section>

    <section id="previews" class="view">
      <div class="container">
        <h2 class="reveal" data-i18n="previews.title">Ù…Ø¹Ø§ÙŠÙ†Ø§Øª ÙˆØªØ¬Ø§Ø±Ø¨</h2>
        <div id="previewsGrid" class="grid reveal"></div>
      </div>
    </section>

    <section id="contact" class="view">
      <div class="container">
        <h2 class="reveal" data-i18n="contact.title">
          Ø¹Ù†Ù‘ÙŠ ÙˆØ§Ù„ØªÙˆØ§ØµÙ„
        </h2>
        <div class="grid reveal">
          <div class="col-6">
            <div class="card3">
              <div class="title" data-i18n="contact.about">Ù†Ø¨Ø°Ø© Ø³Ø±ÙŠØ¹Ø©</div>
              <p id="aboutText" class="muted"
                 data-ar="Ù…Ø·ÙˆÙ‘Ø± ÙÙÙ„-Ø³ØªØ§Ùƒ Ù…ØªØ®ØµØµ ÙÙŠ FiveM ÙˆÙ„ÙˆØ§ + React/NUIØŒ Ù…Ø¹ Ø®Ø¨Ø±Ø© ÙÙŠ ØªØµÙ…ÙŠÙ… Ø£Ù†Ø¸Ù…Ø© Ø§Ù‚ØªØµØ§Ø¯ÙŠØ©ØŒ ÙˆØ§Ø¬Ù‡Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©ØŒ ÙˆØªÙƒØ§Ù…Ù„Ø§Øª Ù…Ø¹ Discord ÙˆMySQL."
                 data-en="Full-stack developer specialized in FiveM, Lua + React/NUI, experienced in economic systems, advanced UIs, and integrations with Discord & MySQL.">
              </p>
              <div class="tags" id="basicFacts"></div>
            </div>
          </div>
          <div class="col-6">
            <div class="card3">
              <div class="title" data-i18n="contact.links">ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„ØªÙˆØ§ØµÙ„</div>
              <div style="display:flex; flex-direction:row; flex-wrap:wrap; padding-top: 20px; gap:10px; align-items:center; justify-content:center;">
                <a class="btn2" id="emailLink" href="#">Email</a>
                <a class="btn2" id="discordLink" href="#">Discord</a>
                <a class="btn2" id="siteLink" href="#" target="_blank" rel="noopener">Website</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>    
  </main>

  <div class="modal" id="imgModal" aria-hidden="true"><img alt="preview" /></div>

  <script>

    const GH_USERNAME = "ISKinGeR"; 

    const FEATURED_REPOS = [
      "Mythic-gangs", "mythic-inventory", "KR-ahs"
    ];

    const REPO_BLACKLIST = [
    ];

    const PREVIEWS = [
      { type: 'youtube', src: 'https://www.youtube.com/watch?v=-Z4KFc-yi30&ab_channel=KinGeR', title: { ar: 'Ø³ÙƒØ±ÙŠØ¨Øª Ø§Ù„Ù…ÙŠØ« Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù„ mythic-framework', en: 'The new meth script for mythic-framework' }, desc: { ar: 'ØªØ¬Ø±Ø¨Ø©.', en: 'preview.' } },
      { type: 'youtube', src: 'https://www.youtube.com/watch?v=lXqu17aoUZA&ab_channel=KinGeR', title: { ar: 'ØªØ¬Ø±Ø¨Ø© Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø¯Ø±ÙˆØ¨ | Ù†Ø³Ø®Ø© Ø§ÙˆÙ„ÙŠØ©', en: 'Test drops script | WIP' }, desc: { ar: '', en: '' } },
      { type: 'youtube', src: 'https://www.youtube.com/watch?v=Auypl9JHOlc&ab_channel=KinGeR', title: { ar: 'ØªØ¬Ø±Ø¨Ø© Ø³ÙƒØ±Ø¨Øª Ø§Ù„ØªØµÙ†ÙŠØ¹ | Ù†Ø³Ø®Ø© Ø§ÙˆÙ„ÙŠØ©', en: 'Test crafting script | WIP' }, desc: { ar: '', en: '' } },
    ];

    const PROFILE = {
      brand: 'Ø­Ø§Ø²Ù…',
      name: 'Ø­Ø§Ø²Ù…',
      age: 24,
      location: { ar: 'Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©', en: 'Saudi Arabia' },
      roles: ['Lua', 'Python', 'FiveM Developer', 'Automate scripts maker', 'React (NUI)'],
      email: 'kinger.noro@gmail.com',
      discord: 'My Discord Server | ZOLO',
      website: 'https://ISKinGeR.github.io',
      cvUrl: 'https://example.com/your-cv.pdf'
    };

    const I18N = {
      ar: {
        'nav.home': 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'nav.projects': 'Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹', 'nav.previews': 'Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø§Øª', 'nav.contact': 'Ø§Ù„ØªÙˆØ§ØµÙ„',
        'home.title': 'Ø£Ù‡Ù„Ø§Ù‹! Ø£Ù†Ø§ Ø­Ø§Ø²Ù… â€” Ù…Ø·ÙˆÙ‘Ø± Ù†Ø¸Ù… ÙˆØ®ÙˆØ§Ø¯Ù… Ø£Ù„Ø¹Ø§Ø¨',
        'home.subtitle': 'Ù‡Ù†Ø§ Ø£Ø¹Ø±Ø¶ Ø£ÙØ¶Ù„ Ø´ØºÙ„ÙŠ: Ø³ÙƒØ±Ø¨ØªØ§ØªØŒ Ø£Ù†Ø¸Ù…Ø©ØŒ ÙˆÙˆØ§Ø¬Ù‡Ø§Øª Ù…Ø®ØµØµØ©. ğŸ‘‹',
        'home.featured': 'Ø£Ø¨Ø±Ø² Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹', 'home.seeAll': 'Ø´ÙˆÙ ÙƒÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹',
        'projects.title': 'ÙƒÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø¹Ø§Ù…Ø©', 'projects.subtitle': 'Auto-fetched from GitHub.',
        'previews.title': 'Ù…Ø¹Ø§ÙŠÙ†Ø§Øª ÙˆØªØ¬Ø§Ø±Ø¨',
        'contact.title': 'Ø¹Ù†Ù‘ÙŠ ÙˆØ§Ù„ØªÙˆØ§ØµÙ„', 'contact.about': 'Ù†Ø¨Ø°Ø© Ø³Ø±ÙŠØ¹Ø©', 'contact.skills': 'Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª', 'contact.links': 'ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„ØªÙˆØ§ØµÙ„', 'contact.cv': 'Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©', 'contact.cvText': 'ØªØ­ØªØ§Ø¬ Ù†Ø³Ø®Ø© PDFØŸ Ø­Ù…Ù‘Ù„Ù‡Ø§ Ù…Ù† Ù‡Ù†Ø§.', 'contact.download': 'ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù€ CV'
      },
      en: {
        'nav.home': 'Home', 'nav.projects': 'Projects', 'nav.previews': 'Previews', 'nav.contact': 'Contact',
        'home.title': 'Hi! Iâ€™m Hazem â€” systems & game servers developer',
        'home.subtitle': 'I showcase my best work: scripts, systems, and custom UIsğŸ‘‹',
        'home.featured': 'Featured Projects', 'home.seeAll': 'See all projects',
        'projects.title': 'All Public Projects', 'projects.subtitle': 'Auto-fetched from GitHub.',
        'previews.title': 'Previews & Demos',
        'contact.title': 'About & Contact', 'contact.about': 'Quick Bio', 'contact.skills': 'Skills', 'contact.links': 'Contacts', 'contact.cv': 'Curriculum Vitae', 'contact.cvText': 'Need a PDF version? Grab it here.', 'contact.download': 'Download CV'
      }
    };


    const state = {
      lang: (localStorage.getItem('lang') || 'ar'),
      repos: [],
    };

    const qs = (s, r=document) => r.querySelector(s);
    const qsa = (s, r=document) => Array.from(r.querySelectorAll(s));

    window.addEventListener('DOMContentLoaded', () => {
      setTimeout(() => qs('#siteHeader').classList.add('enter'), 120);
    });

    function applyRoute() {
      const route = (location.hash.replace('#','') || 'home');
      qsa('section.view').forEach(s => s.classList.remove('active'));
      const el = qs('#'+route) || qs('#home');
      el.classList.add('active');
      qsa('nav a').forEach(a => a.classList.toggle('active', a.dataset.route === route));
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    window.addEventListener('hashchange', applyRoute);

    function setLang(lang) {
      state.lang = lang;
      localStorage.setItem('lang', lang);
      document.documentElement.lang = lang;
      document.documentElement.dir = (lang === 'ar') ? 'rtl' : 'ltr';
      qs('#langToggle').textContent = (lang === 'ar') ? 'EN' : 'AR';
      qsa('[data-i18n]').forEach(node => {
        const key = node.getAttribute('data-i18n');
        const pack = I18N[lang] || {};
        if (pack[key]) node.textContent = pack[key];
      });
      qs('#brandText').textContent = (lang === 'ar') ? (PROFILE.brand || 'Ø­Ø§Ø²Ù…') : (PROFILE.brand_en || 'Hazem');
      renderProfile();
      renderPreviews();
    }

    const io = new IntersectionObserver((entries) => {
      for (const e of entries) if (e.isIntersecting) e.target.classList.add('in');
    }, { threshold: 0.18 });
    function armReveals() { qsa('.reveal').forEach(el => io.observe(el)); }

    async function fetchRepos() {
      const url = `https://api.github.com/users/${GH_USERNAME}/repos?per_page=100&sort=updated`;
      const res = await fetch(url, { headers: { 'Accept': 'application/vnd.github+json' } });
      if (!res.ok) throw new Error('GitHub API error: ' + res.status);
    
      const data = await res.json();
      const filtered = data.filter(r => !r.private && !r.archived && !REPO_BLACKLIST.includes(r.name));
      filtered.sort((a,b) => new Date(b.updated_at) - new Date(a.updated_at));
      return filtered;
    }

    function renderFeatured(repos) {
      const grid = qs('#featuredGrid');
      const featuredTitle = qs('[data-i18n="home.featured"]').parentElement;
      grid.innerHTML = '';

      const pick = (FEATURED_REPOS && FEATURED_REPOS.length)
        ? repos.filter(r => FEATURED_REPOS.includes(r.name))
        : repos.slice(0, 6);
      const selection = pick.slice(0, 6);

      if (selection.length === 0) {
        featuredTitle.style.display = 'none';
        grid.style.display = 'none';
        return;
      } else {
        featuredTitle.style.display = '';
        grid.style.display = '';
      }

      grid.style.display = '';
      grid.style.gridTemplateColumns = '';
      grid.style.justifyContent = '';
      grid.style.alignItems = '';

      if (selection.length === 1) {
        grid.style.display = 'flex';
        grid.style.justifyContent = 'center';
        grid.appendChild(repoCard(selection[0], 'col-6'));
      } else if (selection.length === 2) {
        grid.style.display = 'flex';
        grid.style.justifyContent = 'center';
        grid.style.gap = '20px';
        selection.forEach(r => {
          const el = repoCard(r, 'col-6');
          el.style.maxWidth = '480px';
          grid.appendChild(el);
        });
      } else {
        grid.style.display = 'grid';
        grid.style.gridTemplateColumns = 'repeat(auto-fill, minmax(280px, 1fr))';
        selection.forEach(r => grid.appendChild(repoCard(r, 'col-4')));
      }
    }

    function renderProjects(repos) {
      const grid = qs('#projectsGrid');
      grid.innerHTML = '';
      repos.sort((a, b) => new Date(b.pushed_at) - new Date(a.pushed_at));
      repos.forEach(r => grid.appendChild(repoCard(r, 'col-4')));
    }

    function repoCard(r, col = 'col-4') {
      const c = document.createElement('div');
      c.className = `${col}`;
      c.innerHTML = `
        <div class="card" role="article">
          <div class="title">${r.name}</div>
          <div class="muted">${r.description || ''}</div>
          <div class="tags">
            <span class="tag">â˜… ${r.stargazers_count}</span>
            ${r.language ? `<span class="tag">${r.language}</span>` : ''}
            <span class="tag">${new Date(r.pushed_at).toLocaleDateString()}</span>
          </div>
          <div style="text-align:center; margin-top:12px;">
            <a class="btn" href="${r.html_url}" target="_blank" rel="noopener">GitHub</a>
          </div>
        </div>`;
      return c;
    }

    function toYouTubeEmbed(u) {
      try {
        const url = new URL(u);
        const host = url.hostname;
        if (host.includes('youtu.be')) {
          const id = url.pathname.slice(1);
          const start = ytStartParam(url);
          return `https://www.youtube.com/embed/${id}${start}`;
        }
        if (host.includes('youtube') && url.pathname.startsWith('/watch')) {
          const id = url.searchParams.get('v');
          const start = ytStartParam(url);
          return id ? `https://www.youtube.com/embed/${id}${start}` : u;
        }
        if (host.includes('youtube') && url.pathname.startsWith('/embed/')) {
          return u;
        }
      } catch {}
      return u;
    }
    function ytStartParam(url) {
      const t = url.searchParams.get('t') || url.searchParams.get('start');
      if (!t) return '';
      const m = String(t).match(/(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s)?|^\d+$/);
      if (!m) return '';
      if (/^\d+$/.test(t)) return `?start=${t}`;
      const h = parseInt(m[1] || 0, 10), mn = parseInt(m[2] || 0, 10), s = parseInt(m[3] || 0, 10);
      const total = (h*3600) + (mn*60) + s;
      return total ? `?start=${total}` : '';
    }
    
    function renderPreviews() {
      const grid = qs('#previewsGrid');
      grid.innerHTML = '';
      PREVIEWS.forEach(item => {
        const wrap = document.createElement('div');
        wrap.className = 'col-6';
        const title = item.title?.[state.lang] || item.title?.en || '';
        const desc = item.desc?.[state.lang] || item.desc?.en || '';
        let media = '';
        if (item.type === 'youtube') {
          const embed = toYouTubeEmbed(item.src);
          media = `
            <div class="media">
              <iframe
                src="${embed}"
                title="YouTube"
                loading="lazy"
                referrerpolicy="strict-origin-when-cross-origin"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                allowfullscreen
                frameborder="0"></iframe>
            </div>`;
        } else if (item.type === 'image') {
          media = `<div class="media"><img src="${item.src}" alt="preview" loading="lazy"/></div>`;
        } else if (item.type === 'link') {
          media = `<a class="media" href="${item.href}" target="_blank" rel="noopener"><img src="${item.thumb}" alt="link" loading="lazy"/></a>`;
        }
        wrap.innerHTML = `
          <div class="card2">
            ${media}
            <div class="title" style="margin-top:10px;">${title}</div>
            <div class="muted">${desc}</div>
          </div>`;
        if (item.type === 'image') {
          wrap.querySelector('img').addEventListener('click', () => openLightbox(item.src));
        }
        grid.appendChild(wrap);
      });
    }

    function openLightbox(src) {
      const m = qs('#imgModal');
      m.querySelector('img').src = src;
      m.classList.add('open');
      m.setAttribute('aria-hidden', 'false');
    }
    qs('#imgModal').addEventListener('click', () => {
      qs('#imgModal').classList.remove('open');
      qs('#imgModal').setAttribute('aria-hidden', 'true');
    });

    function renderProfile() {
      qs('#brandText').textContent = (state.lang === 'ar' ? (PROFILE.brand || 'Ø­Ø§Ø²Ù…') : (PROFILE.brand_en || 'Hazem'));
      const facts = qs('#basicFacts');
      facts.innerHTML = '';
      const loc = (state.lang === 'ar' ? PROFILE.location?.ar : PROFILE.location?.en) || '';
      const arr = [ ...PROFILE.roles ];
      arr.forEach(t => { const span = document.createElement('span'); span.className = 'tag'; span.textContent = t; facts.appendChild(span); });
      const emailLink = qs('#emailLink'); emailLink.href = `mailto:${PROFILE.email}`; emailLink.textContent = PROFILE.email;
      const discordLink = qs('#discordLink'); discordLink.href = `https://discord.gg/3mGCt7M8sd`; discordLink.textContent = PROFILE.discord;
      const siteLink = qs('#siteLink'); siteLink.href = PROFILE.website; siteLink.textContent = PROFILE.website.replace('https://','');
    }

    async function init() {
      setLang(state.lang);
      qs('#langToggle').addEventListener('click', () => setLang(state.lang === 'ar' ? 'en' : 'ar'));
      applyRoute();
      renderPreviews();
      renderProfile();
      try {
        const repos = await fetchRepos();
        state.repos = repos;
        renderFeatured(repos);
        renderProjects(repos);
      } catch (e) {
        qs('#projectsError').style.display = 'block';
        qs('#projectsError').textContent = 'ØªØ¹Ø°Ø± Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ù…Ù† GitHub. Ø¬Ø±Ù‘Ø¨ Ø¨Ø¹Ø¯ Ù‚Ù„ÙŠÙ„.';
        console.error(e);
      }
      armReveals();
      startBlob();
    }


    function startBlob(){
      const c = qs('#bgCanvas');
      const ctx = c.getContext('2d');
      let w, h, dpr;

      const blob = { x: 0.5, y: 0.25, r: 240, tx: 0.5, ty: 0.25, vx: 0, vy: 0 };
      let particles = [];
      let lastScrollY = window.scrollY || 0;
      let scrollBias = 0;

      function resize(){
        dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
        w = c.width = Math.floor(innerWidth * dpr);
        h = c.height = Math.floor(innerHeight * dpr);
        c.style.width = innerWidth + 'px';
        c.style.height = innerHeight + 'px';
        seedParticles();
      }

      function seedParticles(){
        const count = Math.min(140, Math.max(50, Math.floor((innerWidth * innerHeight) / 26000)));
        particles = new Array(count).fill(0).map(() => {
          const speed = (0.06 + Math.random()*0.24) * dpr;
          const ang = Math.random() * Math.PI * 2;
          return {
            x: Math.random() * w,
            y: Math.random() * h,
            vx: Math.cos(ang) * speed,
            vy: Math.sin(ang) * speed,
            r: (1.8 + Math.random()*2.6) * dpr,
            a: 0.18 + Math.random()*1.22
          }
        });
      }

      resize();
      window.addEventListener('resize', resize);

      let mx = 0.5, my = 0.3;
      window.addEventListener('mousemove', (e)=>{
        mx = e.clientX / innerWidth; my = e.clientY / innerHeight;
        blob.tx = 0.15 + mx*0.7;
        blob.ty = 0.10 + my*0.6;
      });
      window.addEventListener('scroll', ()=>{
        const y = window.scrollY || 0;
        const dy = Math.max(-200, Math.min(200, y - lastScrollY));
        scrollBias = dy * 0.12 * (window.devicePixelRatio || 1);
        lastScrollY = y;
        const sc = Math.min(1, y / (innerHeight*1.2));
        blob.r = 220 + sc*120;
      }, { passive: true });

      function step(){
        const k = 0.08, damp = 0.85;
        const dx = blob.tx - blob.x, dy = blob.ty - blob.y;
        blob.vx = (blob.vx + dx*k) * damp;
        blob.vy = (blob.vy + dy*k) * damp;
        blob.x += blob.vx; blob.y += blob.vy;

        ctx.clearRect(0,0,w,h);
        const cx = blob.x * w, cy = blob.y * h, r = blob.r * dpr;
        const g = ctx.createRadialGradient(cx, cy, r*0.2, cx, cy, r);
        g.addColorStop(0, 'rgba(125,211,252,0.35)');
        g.addColorStop(1, 'rgba(155,140,255,0.05)');
        ctx.fillStyle = g;
        ctx.beginPath(); ctx.arc(cx, cy, r, 0, Math.PI*2); ctx.fill();

        const mousePullX = (mx - 0.5) * 0.22 * dpr;
        const mousePullY = (my - 0.5) * 0.18 * dpr;
        scrollBias *= 0.92;

        for (let i=0;i<particles.length;i++){
          const p = particles[i];
          p.x += p.vx + mousePullX;
          p.y += p.vy + mousePullY + (scrollBias * 0.02);

          const margin = 60 * dpr;
          if (p.x < -margin) p.x = w + margin;
          if (p.x > w + margin) p.x = -margin;
          if (p.y < -margin) p.y = h + margin;
          if (p.y > h + margin) p.y = -margin;

          ctx.beginPath();
          ctx.fillStyle = `rgba(125,211,252,${p.a})`;
          ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
          ctx.fill();
        }

        requestAnimationFrame(step);
      }
      step();
    }

    init();
  </script>
</body>
</html>
